<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function applies the Nutrient Aggregation logic
from ECHO's Water Pollutant Loading Tool to add nitrogen subspecies together
to approximate a total nitrogen value on a single day at a single site.
Before summing subspecies, this function runs TADA_AggregateMeasurements to
obtain the max value of a characteristic-fraction-speciation at a given site,
date, and depth. Where necessary, it uses conversion factors to convert
nitrogen subspecies expressed as nitrate, nitrite, ammonia, ammonium, etc. to
as nitrogen based on the atomic weights of the different elements in the
compound. The reference table is contained within the package but may be
edited/customized by users. Nutrient equations are as follows:"><title>Calculate Total Nitrogen and Phosphorus — TADA_CalculateTotalNP • TADA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Total Nitrogen and Phosphorus — TADA_CalculateTotalNP"><meta property="og:description" content="This function applies the Nutrient Aggregation logic
from ECHO's Water Pollutant Loading Tool to add nitrogen subspecies together
to approximate a total nitrogen value on a single day at a single site.
Before summing subspecies, this function runs TADA_AggregateMeasurements to
obtain the max value of a characteristic-fraction-speciation at a given site,
date, and depth. Where necessary, it uses conversion factors to convert
nitrogen subspecies expressed as nitrate, nitrite, ammonia, ammonium, etc. to
as nitrogen based on the atomic weights of the different elements in the
compound. The reference table is contained within the package but may be
edited/customized by users. Nutrient equations are as follows:"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TADA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../articles/TADAModule1_AdvancedTraining.html">TADA Module 1: Training for Intermediate/Advanced R Users</a>
    <a class="dropdown-item" href="../articles/TADAModule1_BeginnerTraining.html">TADA Module 1: Training for Beginner R Users</a>
    <a class="dropdown-item" href="../articles/TADAModule1.html">TADA Module 1: Water Quality Portal Data Discovery and Cleaning</a>
    <a class="dropdown-item" href="../articles/TADAModule2.html">TADA Module 2: Geospatial Functions</a>
    <a class="dropdown-item" href="../articles/WQXValidationService.html">WQX QAQC Service User Guide</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/TADA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate Total Nitrogen and Phosphorus</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/TADA/blob/HEAD/R/Transformations.R" class="external-link"><code>R/Transformations.R</code></a></small>
      <div class="d-none name"><code>TADA_CalculateTotalNP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies the <a href="https://echo.epa.gov/trends/loading-tool/resources/nutrient-aggregation#nitrogen" class="external-link">Nutrient Aggregation logic</a>
from ECHO's Water Pollutant Loading Tool to add nitrogen subspecies together
to approximate a total nitrogen value on a single day at a single site.
Before summing subspecies, this function runs TADA_AggregateMeasurements to
obtain the max value of a characteristic-fraction-speciation at a given site,
date, and depth. Where necessary, it uses conversion factors to convert
nitrogen subspecies expressed as nitrate, nitrite, ammonia, ammonium, etc. to
as nitrogen based on the atomic weights of the different elements in the
compound. The reference table is contained within the package but may be
edited/customized by users. Nutrient equations are as follows:</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TADA_CalculateTotalNP</span><span class="op">(</span><span class="va">.data</span>, <span class="va">sum_ref</span>, daily_agg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span>, <span class="st">"mean"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>TADA dataframe, ideally harmonized using TADA_HarmonizeSynonyms.
If user wants to consider grouping N or P subspecies across multiple
organizations, user should have run TADA_FindNearbySites and grouped all
nearby sites to one common MonitoringLocationIdentifier,
TADA.LatitudeMeasure, TADA.LongitudeMeasure, etc.</p></dd>


<dt>sum_ref</dt>
<dd><p>Optional. A custom summation reference dataframe the user has
loaded into the R environment. Dataframe must have same columns as default
TADA.summation reference table.</p></dd>


<dt>daily_agg</dt>
<dd><p>The function used to aggregate to a single
characteristic-unit-fraction-speciation at the same location and depth on
the same day for multiple measurements. Defaults to 'max', but can be set
to 'min' or 'mean'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Input TADA dataframe with additional rows representing total N and P
summation values from adding up subspecies. Note that for total phosphorus,
these additional rows are simply a re-classification of phosphorus or
phosphate into the total phosphorus as P format. These new rows share the
same date and monitoring location as the subspecies, but an additional note
is added in the TADA.NutrientSummation.Flag column describing how the total
was derived. Also adds TADA.NutrientSummationGroup and
TADA.NutrientSummationEquation columns, which can be used to trace how the
total was calculated and from which subspecies.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>NITROGEN:</p><ol><li><p>TOTAL N (UNFILTERED)</p></li>
<li><p>TOTAL N (FILTERED) + TOTAL N (PARTICULATE)</p></li>
<li><p>TOTAL KJELDAHL NITROGEN + NITRATE + NITRITE</p></li>
<li><p>ORGANIC N + AMMONIA + NITRATE + NITRITE</p></li>
<li><p>OTHER NITROGEN FORMS</p></li>
</ol><p>PHOSPHORUS:</p><ol><li><p>TOTAL PHOSPHORUS</p></li>
<li><p>PHOSPHATE</p></li>
<li><p>OTHER PHOSPHORUS FORMS</p></li>
</ol><p>Equations are applied in the order above. The function looks for groups of
nutrients that exactly match each equation before looking for every
combination within each equation (for example, a group of nitrogen subspecies
including AMMONIA and NITRATE will be passed over in an initial sweep of
groups of subspecies containing ORG N, AMMONIA, NITRATE, and NITRITE, but
will be caught as the function moves down the hierarchy of equations to fewer
and fewer subspecies). Eventually, even groups with only one subspecies will
be used to represent a TOTAL N value for that site/day/depth.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by U.S. Environmental Protection Agency, Cristina Mullin, Jacob Greif, Elise Hinman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

