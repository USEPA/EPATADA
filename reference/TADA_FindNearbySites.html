<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify and group nearby monitoring locations (UNDER ACTIVE DEVELOPMENT) — TADA_FindNearbySites • EPATADA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify and group nearby monitoring locations (UNDER ACTIVE DEVELOPMENT) — TADA_FindNearbySites"><meta name="description" content="This function takes a TADA dataset and identifies the NHD catchments that
each MonitoringLocation is in. Within each group of MonitoringLocations in
the same catchment, a distance matrix is created and an adjacency matrix
is used to identify groups of nearby sites within the same catchment.
Groups of nearby sites are given a new TADA.MonitoringLocationIdentifier
which is created by concatenating the original
TADA.MonitoringLocationIdentifiers of all sites within the group. Two
additional columns, TADA.NearbySiteGroup and TADA.NearbySites.Flag are added.
TADA.NearbySiteGroup contains a unique numeric value for each group of sites
within the same catchment. TADA.NearbySites.Flag identifies whether or not
a result is from a grouped site or not and for grouped sites identifies how
the TADA prefixed metadata columns (TADA.MonitoringLocationName,
TADA.MonitoringLocationTypeName, TADA.LongitudeMeasure, and
TADA.LatitudeMeasure) were determined."><meta property="og:description" content="This function takes a TADA dataset and identifies the NHD catchments that
each MonitoringLocation is in. Within each group of MonitoringLocations in
the same catchment, a distance matrix is created and an adjacency matrix
is used to identify groups of nearby sites within the same catchment.
Groups of nearby sites are given a new TADA.MonitoringLocationIdentifier
which is created by concatenating the original
TADA.MonitoringLocationIdentifiers of all sites within the group. Two
additional columns, TADA.NearbySiteGroup and TADA.NearbySites.Flag are added.
TADA.NearbySiteGroup contains a unique numeric value for each group of sites
within the same catchment. TADA.NearbySites.Flag identifies whether or not
a result is from a grouped site or not and for grouped sites identifies how
the TADA prefixed metadata columns (TADA.MonitoringLocationName,
TADA.MonitoringLocationTypeName, TADA.LongitudeMeasure, and
TADA.LatitudeMeasure) were determined."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EPATADA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../articles/TADAAssessmentUnitUseCase.html">TADA: Assessment Unit Use Case Demo</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule1_AdvancedTraining.html">TADA Module 1: Training for Intermediate/Advanced R Users</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule1_BeginnerTraining.html">TADA Module 1: Training for Beginner R Users</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule1.html">TADA Module 1: Water Quality Portal Data Discovery and Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule2.html">TADA Module 2: Geospatial Functions</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule3_PartA.html">TADA Module 3A: Associating WQP Characteristic Names with Applicable ATTAINS State, Tribal or EPA 304(a) Parameter and Use Names</a></li>
    <li><a class="dropdown-item" href="../articles/TADAWaterSciConWorkshopDemo.html">TADA: WaterSciCon Workshop Demo</a></li>
    <li><a class="dropdown-item" href="../articles/WQXValidationService.html">WQX QAQC Service User Guide</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USEPA/EPATADA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Identify and group nearby monitoring locations (UNDER ACTIVE DEVELOPMENT)</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/EPATADA/blob/develop/R/Utilities.R" class="external-link"><code>R/Utilities.R</code></a></small>
      <div class="d-none name"><code>TADA_FindNearbySites.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a TADA dataset and identifies the NHD catchments that
each MonitoringLocation is in. Within each group of MonitoringLocations in
the same catchment, a distance matrix is created and an adjacency matrix
is used to identify groups of nearby sites within the same catchment.
Groups of nearby sites are given a new TADA.MonitoringLocationIdentifier
which is created by concatenating the original
TADA.MonitoringLocationIdentifiers of all sites within the group. Two
additional columns, TADA.NearbySiteGroup and TADA.NearbySites.Flag are added.
TADA.NearbySiteGroup contains a unique numeric value for each group of sites
within the same catchment. TADA.NearbySites.Flag identifies whether or not
a result is from a grouped site or not and for grouped sites identifies how
the TADA prefixed metadata columns (TADA.MonitoringLocationName,
TADA.MonitoringLocationTypeName, TADA.LongitudeMeasure, and
TADA.LatitudeMeasure) were determined.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TADA_FindNearbySites</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  dist_buffer <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  nhd_res <span class="op">=</span> <span class="st">"Hi"</span>,</span>
<span>  org_hierarchy <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  meta_select <span class="op">=</span> <span class="st">"random"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>TADA dataframe OR TADA sites dataframe.</p></dd>


<dt id="arg-dist-buffer">dist_buffer<a class="anchor" aria-label="anchor" href="#arg-dist-buffer"></a></dt>
<dd><p>Numeric. The maximum distance (in meters) two sites can be
from one another to be considered "nearby" and grouped together.</p></dd>


<dt id="arg-nhd-res">nhd_res<a class="anchor" aria-label="anchor" href="#arg-nhd-res"></a></dt>
<dd><p>Character argument to determine whether the NHD catchments
used should be high ("Hi") or medium ("Med") res. Default = "Hi" for
consistency with other TADA geospatial functions.</p></dd>


<dt id="arg-org-hierarchy">org_hierarchy<a class="anchor" aria-label="anchor" href="#arg-org-hierarchy"></a></dt>
<dd><p>Vector of organization identifiers that acts as the
order in which the function should select representative metadata for
grouped sites based on the organization that collected the data. If left
blank, the function does not factor organization in to the metadata
selection process. When a vector is provided, the metadata will first be
selected by organization and the "meta_select" argument will only be
applied in cases where more than one set of metadata per site grouping are
available from the highest ranking organization available.</p></dd>


<dt id="arg-meta-select">meta_select<a class="anchor" aria-label="anchor" href="#arg-meta-select"></a></dt>
<dd><p>Character argument to determine how metadata should be
selected if no org_hierarchy is specified or if multiple options for metadata
from the same organization exist. Options are "oldest", which selects the
metadata associated with the oldest result from the grouped nearby sites,
"newest", which selects the metadata associated with the newest result from
the grouped nearby sites, "count" which selects the metadata associated with
the greatest number of results, and "random" which selects random metadata
from the site group. The default is meta_select = "random".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Input dataframe with a TADA.SiteGroup column that indicates the
nearby site group each monitoring location belongs to. Grouped sites are
concatenated in the TADA.MonitoringLocationIdentifier column
(e.g. "USGS-10010025","USGS-10010026" enclosed in square brackets []).
This JSON array is the new TADA monitoring location ID for the grouped sites.
TADA.MonitoringLocationIdentifier can be leveraged to analyze data from
nearby sites together (as the same general location). Related metadata,
including TADA.MonitoringLocationName, TADA.LatitudeMeasure,
TADA.LongitudeMeasure, and TADA.MonitoringLocationTypeName are added to the
input df. Meta data selection is determined by user inputs as users may
provide an organization hierarchy to determine which organization's
metadata should be preferentially selected and further specify whether
metadata should be selected: randomly, by the oldest or newest sampling date,
or by the site with the greatest number of overall results in the TADA df.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">GroupNearbySites_100m</span> <span class="op">&lt;-</span> <span class="fu">TADA_FindNearbySites</span><span class="op">(</span><span class="va">Data_Nutrients_UT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Transforming your data into a spatial object."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Your WQP dataframe contains observations without a listed coordinate reference system (CRS). For these, we have assigned CRS 4326."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TADA_FindNearbySites: No org_hierarchy supplied by user. Organization will not be taken into account during metadata selection."</span>
<span class="r-in"><span><span class="va">GroupNearbySites_10m</span> <span class="op">&lt;-</span> <span class="fu">TADA_FindNearbySites</span><span class="op">(</span><span class="va">Data_Nutrients_UT</span>,</span></span>
<span class="r-in"><span>  dist_buffer <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Transforming your data into a spatial object."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Your WQP dataframe contains observations without a listed coordinate reference system (CRS). For these, we have assigned CRS 4326."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TADA_FindNearbySites: No org_hierarchy supplied by user. Organization will not be taken into account during metadata selection."</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cristina Mullin, Hillary Marler, Jacob Greif, Elise Hinman, Kenny Wong, Kathryn Willi, Matt Brousil, Kathleen Healy, Justin Bousquin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

