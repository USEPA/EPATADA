<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Large WQP data pulls using dataRetrieval — TADA_BigDataRetrieval • EPATADA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Large WQP data pulls using dataRetrieval — TADA_BigDataRetrieval"><meta name="description" content="This function does multiple synchronous data calls to the WQP
(waterqualitydata.us). It uses the WQP summary service to limit the amount
downloaded to only relevant data (based on user query), pulls back data for
250000 records at a time, and then joins the data back together to produce a
single TADA compatible dataframe as the output. For large data sets, that can save a lot
of time and ultimately reduce the complexity of subsequent data processing.
Using this function, you will be able to download all data available from all
sites in the contiguous United States available for the time period,
characteristicName, and siteType requested. Computer memory may limit the
size of data frames that your R console will be able to hold in one session.
Function requires a characteristicName, siteType, statecode, huc, or start/
end date input. The recommendation is to be as specific as you can with your
large data call. The function allows the user to run TADA_AutoClean on the data frame,
but this is not the default as checking large dataframes for exact duplicate
rows can be time consuming and is better performed on its own once the query is
completed."><meta property="og:description" content="This function does multiple synchronous data calls to the WQP
(waterqualitydata.us). It uses the WQP summary service to limit the amount
downloaded to only relevant data (based on user query), pulls back data for
250000 records at a time, and then joins the data back together to produce a
single TADA compatible dataframe as the output. For large data sets, that can save a lot
of time and ultimately reduce the complexity of subsequent data processing.
Using this function, you will be able to download all data available from all
sites in the contiguous United States available for the time period,
characteristicName, and siteType requested. Computer memory may limit the
size of data frames that your R console will be able to hold in one session.
Function requires a characteristicName, siteType, statecode, huc, or start/
end date input. The recommendation is to be as specific as you can with your
large data call. The function allows the user to run TADA_AutoClean on the data frame,
but this is not the default as checking large dataframes for exact duplicate
rows can be time consuming and is better performed on its own once the query is
completed."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EPATADA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../articles/TADAAssessmentUnitUseCase.html">TADA: Assessment Unit Use Case Demo</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule1_AdvancedTraining.html">TADA Module 1: Training for Intermediate/Advanced R Users</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule1_BeginnerTraining.html">TADA Module 1: Training for Beginner R Users</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule1.html">TADA Module 1: Water Quality Portal Data Discovery and Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/TADAModule2.html">TADA Module 2: Geospatial Functions</a></li>
    <li><a class="dropdown-item" href="../articles/TADAWaterSciConWorkshopDemo.html">TADA: WaterSciCon Workshop Demo</a></li>
    <li><a class="dropdown-item" href="../articles/WQXValidationService.html">WQX QAQC Service User Guide</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USEPA/EPATADA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Large WQP data pulls using dataRetrieval</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/EPATADA/blob/develop/R/DataDiscoveryRetrieval.R" class="external-link"><code>R/DataDiscoveryRetrieval.R</code></a></small>
      <div class="d-none name"><code>TADA_BigDataRetrieval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function does multiple synchronous data calls to the WQP
(waterqualitydata.us). It uses the WQP summary service to limit the amount
downloaded to only relevant data (based on user query), pulls back data for
250000 records at a time, and then joins the data back together to produce a
single TADA compatible dataframe as the output. For large data sets, that can save a lot
of time and ultimately reduce the complexity of subsequent data processing.
Using this function, you will be able to download all data available from all
sites in the contiguous United States available for the time period,
characteristicName, and siteType requested. Computer memory may limit the
size of data frames that your R console will be able to hold in one session.
Function requires a characteristicName, siteType, statecode, huc, or start/
end date input. The recommendation is to be as specific as you can with your
large data call. The function allows the user to run TADA_AutoClean on the data frame,
but this is not the default as checking large dataframes for exact duplicate
rows can be time consuming and is better performed on its own once the query is
completed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TADA_BigDataRetrieval</span><span class="op">(</span></span>
<span>  startDate <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  endDate <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  countrycode <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  statecode <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  countycode <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  huc <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  siteid <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  siteType <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  characteristicName <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  characteristicType <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  sampleMedia <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  organization <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>  maxrecs <span class="op">=</span> <span class="fl">250000</span>,</span>
<span>  applyautoclean <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-startdate">startDate<a class="anchor" aria-label="anchor" href="#arg-startdate"></a></dt>
<dd><p>Start Date string in the format YYYY-MM-DD, for example, "2020-01-01"</p></dd>


<dt id="arg-enddate">endDate<a class="anchor" aria-label="anchor" href="#arg-enddate"></a></dt>
<dd><p>End Date string in the format YYYY-MM-DD, for example, "2020-01-01"</p></dd>


<dt id="arg-countrycode">countrycode<a class="anchor" aria-label="anchor" href="#arg-countrycode"></a></dt>
<dd><p>Code that identifies a country or ocean (e.g. countrycode = "CA" for Canada, countrycode = "OA" for Atlantic Ocean). See https://www.waterqualitydata.us/Codes/countrycode for options.</p></dd>


<dt id="arg-statecode">statecode<a class="anchor" aria-label="anchor" href="#arg-statecode"></a></dt>
<dd><p>FIPS state alpha code that identifies a state (e.g. statecode = "DE" for Delaware). See https://www.waterqualitydata.us/Codes/statecode for options.</p></dd>


<dt id="arg-countycode">countycode<a class="anchor" aria-label="anchor" href="#arg-countycode"></a></dt>
<dd><p>FIPS county name. Note that a state code must also be supplied (e.g. statecode = "AL", countycode = "Chilton"). See https://www.waterqualitydata.us/Codes/countycode for options.</p></dd>


<dt id="arg-huc">huc<a class="anchor" aria-label="anchor" href="#arg-huc"></a></dt>
<dd><p>A numeric code denoting a hydrologic unit. Example: "04030202". Different size hucs can be entered. See https://epa.maps.arcgis.com/home/item.html?id=796992f4588c401fabec7446ecc7a5a3 for a map with HUCS. Click on a HUC to find the associated code.</p></dd>


<dt id="arg-siteid">siteid<a class="anchor" aria-label="anchor" href="#arg-siteid"></a></dt>
<dd><p>Unique monitoring location identifier.</p></dd>


<dt id="arg-sitetype">siteType<a class="anchor" aria-label="anchor" href="#arg-sitetype"></a></dt>
<dd><p>Type of waterbody. See https://www.waterqualitydata.us/Codes/sitetype for options.</p></dd>


<dt id="arg-characteristicname">characteristicName<a class="anchor" aria-label="anchor" href="#arg-characteristicname"></a></dt>
<dd><p>Name of parameter. See https://www.waterqualitydata.us/Codes/characteristicName for options.</p></dd>


<dt id="arg-characteristictype">characteristicType<a class="anchor" aria-label="anchor" href="#arg-characteristictype"></a></dt>
<dd><p>Groups of environmental measurements/parameters. See https://www.waterqualitydata.us/Codes/characteristicType for options.</p></dd>


<dt id="arg-samplemedia">sampleMedia<a class="anchor" aria-label="anchor" href="#arg-samplemedia"></a></dt>
<dd><p>Sampling substrate such as water, air, or sediment. See https://www.waterqualitydata.us/Codes/sampleMedia for options.</p></dd>


<dt id="arg-organization">organization<a class="anchor" aria-label="anchor" href="#arg-organization"></a></dt>
<dd><p>A string of letters and/or numbers (some additional characters also possible) used to signify an organization with data in the Water Quality Portal. See https://www.waterqualitydata.us/Codes/organization for options.</p></dd>


<dt id="arg-maxrecs">maxrecs<a class="anchor" aria-label="anchor" href="#arg-maxrecs"></a></dt>
<dd><p>The maximum number of results queried within one call to dataRetrieval.</p></dd>


<dt id="arg-applyautoclean">applyautoclean<a class="anchor" aria-label="anchor" href="#arg-applyautoclean"></a></dt>
<dd><p>Logical, defaults to FALSE. If TRUE, runs TADA_AutoClean function on the returned data profile.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>TADA-compatible dataframe</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Some code for this function was adapted from this USGS Blog (Author: Aliesha Krall)
<a href="https://waterdata.usgs.gov/blog/large_sample_pull/" class="external-link">Large Sample Pull</a></p>
<p>See ?TADA_AutoClean documentation for more information on this optional input.</p>
<p>Note: TADA_BigDataRetrieval (by leveraging USGS's dataRetrieval),  automatically converts
the date times to UTC. It also automatically converts the data to dates,
datetimes, numerics based on a standard algorithm. See: ?dataRetrieval::readWQPdata</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># takes approx 3 mins to run</span></span></span>
<span class="r-in"><span><span class="va">tada1</span> <span class="op">&lt;-</span> <span class="fu">TADA_BigDataRetrieval</span><span class="op">(</span>startDate <span class="op">=</span> <span class="st">"2019-01-01"</span>, endDate <span class="op">=</span> <span class="st">"2021-12-31"</span>, characteristicName <span class="op">=</span> <span class="st">"Temperature, water"</span>, statecode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AK"</span>, <span class="st">"AL"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># takes approx 21 mins</span></span></span>
<span class="r-in"><span><span class="va">tada2</span> <span class="op">&lt;-</span> <span class="fu">TADA_BigDataRetrieval</span><span class="op">(</span>startDate <span class="op">=</span> <span class="st">"2016-10-01"</span>, endDate <span class="op">=</span> <span class="st">"2022-09-30"</span>, statecode <span class="op">=</span> <span class="st">"UT"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># takes seconds to run</span></span></span>
<span class="r-in"><span><span class="va">tada3</span> <span class="op">&lt;-</span> <span class="fu">TADA_BigDataRetrieval</span><span class="op">(</span>huc <span class="op">=</span> <span class="st">"04030202"</span>, characteristicName <span class="op">=</span> <span class="st">"Escherichia coli"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># takes approx 3 mins to run</span></span></span>
<span class="r-in"><span><span class="va">tada4</span> <span class="op">&lt;-</span> <span class="fu">TADA_BigDataRetrieval</span><span class="op">(</span>startDate <span class="op">=</span> <span class="st">"2004-01-01"</span>, countrycode <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># takes seconds to run</span></span></span>
<span class="r-in"><span><span class="va">tada5</span> <span class="op">&lt;-</span> <span class="fu">TADA_BigDataRetrieval</span><span class="op">(</span>startDate <span class="op">=</span> <span class="st">"2018-01-01"</span>, statecode <span class="op">=</span> <span class="st">"AL"</span>, countycode <span class="op">=</span> <span class="st">"Chilton"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># takes seconds to run</span></span></span>
<span class="r-in"><span><span class="va">tada6</span> <span class="op">&lt;-</span> <span class="fu">TADA_BigDataRetrieval</span><span class="op">(</span>organization <span class="op">=</span> <span class="st">"PUEBLOOFTESUQUE"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by U.S. Environmental Protection Agency, Cristina Mullin, Hillary Marler, Jacob Greif, Elise Hinman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

